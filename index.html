<!DOCTYPE html>
<html>
  <head>
    <title>EEDF</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="shortcut icon" href="img/favicon.ico">
    <link rel="stylesheet" href="css/leaflet.css">
    <link rel="stylesheet" href="css/fontawesome.css">
    <link rel="stylesheet" href="css/easy-button.css">
    <link rel="stylesheet" href="css/spin.css">
    <link rel="stylesheet" href="css/eedf.css">
    <script src="js/jquery/jquery-3.3.1.min.js"></script>
    <script src="js/jquery/jquery.csv.min.js"></script>
    <script src="js/leaflet/leaflet.js"></script>
    <script src="js/leaflet/leaflet.browser.print.min.js"></script>
    <script src="js/leaflet/leaflet.easy-button.js"></script>
    <script src="js/leaflet/leaflet.shp.js"></script>
    <script src="js/leaflet/leaflet.shpfile.js"></script>
    <script src="js/leaflet/leaflet.spin.min.js"></script>
    <script src="js/rainbowvis/rainbowvis.js"></script>
    <script src="js/spin/spin.js"></script>
    <!-- polyfill for IE -->
    <script src="js/polyfills/array.find.js"></script>
    <!-- polyfill for Edge -->
    <script src="js/polyfills/encoding.js"></script>
  </head>
  <body>
    <div id="map"></div>
    <script src="js/config.js"></script>
    <script src="js/data.js"></script>
    <script src="js/maps/eedf.js"></script>
    <script src="js/maps/camps.js"></script>
    <script type="text/javascript">
      var tileLayer,
        map,
        features = {},
        infos = {},
        viewId = "CampsMap";

      function initTileLayer() {
        // Mapbox custom tile layer
        tileLayer = L.tileLayer("{urlTemplate}/{z}/{x}/{y}?access_token={accessToken}", {
          urlTemplate: mapboxConfig.urlTemplate,
          accessToken: mapboxConfig.accessToken
        });
      }

      function createMap() {
        map = L.map("map", {
          minZoom: 6,
          maxZoom: 7,
          zoomDelta: 0.25,
          zoomSnap: 0
        });
        map.setView([47, 2], 6.5); // France GPS coordinates
        map.addLayer(tileLayer);
      }

      function addIcons() {
        L.easyButton('fa-campground', function() {       
          selectMap("CampsMap");
        }, 'Nombre de camps par d√©partement').addTo(map);
      }

      function resetMap() {
        var feature = features[viewId];
        var info = infos[viewId];

        // remove feature layer
        if (map.hasLayer(feature)) {
          map.removeLayer(feature);
        }

        // remove info layer
        if (map.hasLayer(info)) {
          map.removeLayer(info);
        }
      }

      function loadView(viewId) {
        this.viewId = viewId;

        if (features[viewId] || infos[viewId]) {
          // view is already loaded
          return;
        }

        new window[viewId]().load();
      }

      function updateMap() {
        features[viewId].addTo(map);
        infos[viewId].addTo(map);
      }

      function selectMap(viewId) {
        resetMap(viewId);

        loadView(viewId);

        updateMap();
      }

      $(function() {
        // init tile layer
        initTileLayer();

        // create map
        createMap();

        // add icons to choose the map
        addIcons();

        // add an icon to print the map
        L.control.browserPrint(browserPrintConfig.options).addTo(map);
      });
    </script>
  </body>
</html>